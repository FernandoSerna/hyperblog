VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmclientes2 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Clientes"
   ClientHeight    =   7350
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   11670
   Icon            =   "frmclientes2.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   Moveable        =   0   'False
   ScaleHeight     =   7350
   ScaleWidth      =   11670
   Begin VB.Frame Frame3 
      Height          =   2340
      Index           =   3
      Left            =   5865
      TabIndex        =   27
      Top             =   4800
      Width           =   5640
      Begin MSComctlLib.ListView lv_clientes 
         Height          =   2115
         Left            =   60
         TabIndex        =   12
         Top             =   150
         Width           =   5520
         _ExtentX        =   9737
         _ExtentY        =   3731
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   -1  'True
         HideSelection   =   -1  'True
         FullRowSelect   =   -1  'True
         GridLines       =   -1  'True
         _Version        =   393217
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         BorderStyle     =   1
         Appearance      =   1
         NumItems        =   2
         BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            Text            =   "Clave"
            Object.Width           =   2117
         EndProperty
         BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   1
            Text            =   "Nombre"
            Object.Width           =   7232
         EndProperty
      End
   End
   Begin VB.Frame Frame1 
      Caption         =   " Clientes "
      Height          =   1020
      Index           =   3
      Left            =   5865
      TabIndex        =   24
      Top             =   3765
      Width           =   5640
      Begin VB.TextBox txt_nombre_cliente 
         Height          =   315
         Left            =   1200
         MaxLength       =   50
         TabIndex        =   11
         Top             =   585
         Width           =   4335
      End
      Begin VB.TextBox txt_cliente 
         Height          =   315
         Left            =   1200
         TabIndex        =   10
         Top             =   240
         Width           =   1155
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Nombre:"
         Height          =   195
         Index           =   24
         Left            =   150
         TabIndex        =   26
         Top             =   645
         Width           =   600
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Clave:"
         Height          =   195
         Index           =   23
         Left            =   150
         TabIndex        =   25
         Top             =   330
         Width           =   450
      End
   End
   Begin VB.Frame Frame3 
      Height          =   2340
      Index           =   1
      Left            =   5865
      TabIndex        =   23
      Top             =   1305
      Width           =   5640
      Begin MSComctlLib.ListView lv_gruposreales 
         Height          =   2115
         Left            =   60
         TabIndex        =   6
         Top             =   150
         Width           =   5520
         _ExtentX        =   9737
         _ExtentY        =   3731
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   -1  'True
         HideSelection   =   -1  'True
         FullRowSelect   =   -1  'True
         GridLines       =   -1  'True
         _Version        =   393217
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         BorderStyle     =   1
         Appearance      =   1
         NumItems        =   2
         BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            Text            =   "Clave"
            Object.Width           =   1764
         EndProperty
         BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   1
            Text            =   "Nombre"
            Object.Width           =   7602
         EndProperty
      End
   End
   Begin VB.Frame Frame1 
      Caption         =   " Grupos Reales "
      Height          =   1020
      Index           =   1
      Left            =   5865
      TabIndex        =   20
      Top             =   285
      Width           =   5640
      Begin VB.TextBox txt_nombre_grupo_real 
         Height          =   315
         Left            =   1200
         TabIndex        =   5
         Top             =   585
         Width           =   4335
      End
      Begin VB.TextBox txt_grupo_real 
         Height          =   315
         Left            =   1200
         TabIndex        =   4
         Top             =   240
         Width           =   1155
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Nombre:"
         Height          =   195
         Index           =   3
         Left            =   150
         TabIndex        =   22
         Top             =   645
         Width           =   600
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Clave:"
         Height          =   195
         Index           =   5
         Left            =   150
         TabIndex        =   21
         Top             =   300
         Width           =   450
      End
   End
   Begin VB.Frame Frame3 
      Height          =   2340
      Index           =   2
      Left            =   135
      TabIndex        =   19
      Top             =   4800
      Width           =   5640
      Begin MSComctlLib.ListView lv_titulares 
         Height          =   2115
         Left            =   60
         TabIndex        =   9
         Top             =   150
         Width           =   5520
         _ExtentX        =   9737
         _ExtentY        =   3731
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   -1  'True
         HideSelection   =   -1  'True
         FullRowSelect   =   -1  'True
         GridLines       =   -1  'True
         _Version        =   393217
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         BorderStyle     =   1
         Appearance      =   1
         NumItems        =   2
         BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            Text            =   "Clave"
            Object.Width           =   2117
         EndProperty
         BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   1
            Text            =   "Nombre"
            Object.Width           =   7585
         EndProperty
      End
   End
   Begin VB.Frame Frame3 
      Height          =   2340
      Index           =   0
      Left            =   135
      TabIndex        =   18
      Top             =   1305
      Width           =   5640
      Begin MSComctlLib.ListView lv_gruposactuales 
         Height          =   2115
         Left            =   60
         TabIndex        =   3
         Top             =   150
         Width           =   5520
         _ExtentX        =   9737
         _ExtentY        =   3731
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   -1  'True
         HideSelection   =   -1  'True
         FullRowSelect   =   -1  'True
         GridLines       =   -1  'True
         _Version        =   393217
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         BorderStyle     =   1
         Appearance      =   1
         NumItems        =   4
         BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            Text            =   "Clave"
            Object.Width           =   1764
         EndProperty
         BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   1
            Text            =   "Nombre"
            Object.Width           =   7585
         EndProperty
         BeginProperty ColumnHeader(3) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   2
            Text            =   "descuento1"
            Object.Width           =   0
         EndProperty
         BeginProperty ColumnHeader(4) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   3
            Text            =   "descuento2"
            Object.Width           =   0
         EndProperty
      End
   End
   Begin VB.Frame Frame1 
      Caption         =   " Grupos Actuales "
      Height          =   1020
      Index           =   0
      Left            =   135
      TabIndex        =   15
      Top             =   285
      Width           =   5640
      Begin VB.TextBox txt_nombre_grupo_actual 
         Height          =   315
         Left            =   1200
         TabIndex        =   2
         Top             =   585
         Width           =   4335
      End
      Begin VB.TextBox txt_grupo_actual 
         Height          =   315
         Left            =   1200
         TabIndex        =   1
         Top             =   240
         Width           =   1155
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Nombre"
         Height          =   195
         Index           =   1
         Left            =   150
         TabIndex        =   17
         Top             =   645
         Width           =   555
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Clave:"
         Height          =   195
         Index           =   0
         Left            =   150
         TabIndex        =   16
         Top             =   300
         Width           =   450
      End
   End
   Begin VB.Frame Frame1 
      Caption         =   " Titulares "
      Height          =   1020
      Index           =   2
      Left            =   135
      TabIndex        =   0
      Top             =   3765
      Width           =   5640
      Begin VB.TextBox txt_nombre_titular 
         Height          =   315
         Left            =   1200
         TabIndex        =   8
         Top             =   585
         Width           =   4335
      End
      Begin VB.TextBox txt_titular 
         Height          =   315
         Left            =   1200
         TabIndex        =   7
         Top             =   240
         Width           =   1155
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Nombre:"
         Height          =   195
         Index           =   8
         Left            =   150
         TabIndex        =   14
         Top             =   645
         Width           =   600
      End
      Begin VB.Label lab_paises 
         AutoSize        =   -1  'True
         Caption         =   "Clave:"
         Height          =   195
         Index           =   13
         Left            =   150
         TabIndex        =   13
         Top             =   300
         Width           =   450
      End
   End
   Begin MSComctlLib.ImageList ImageList1 
      Index           =   1
      Left            =   -15
      Top             =   0
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   11
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":08CA
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":11A4
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":1A7E
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":201A
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":28F4
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":31CE
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":3AA8
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":3DC2
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":40DC
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":4678
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmclientes2.frx":4992
            Key             =   ""
         EndProperty
      EndProperty
   End
End
Attribute VB_Name = "frmclientes2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim var_grupoactal As Integer
Dim var_gruporeal As String
Dim var_tituales As Integer
Dim contador_grupos_actuales As Integer
Dim contador_grupos_reales As Integer
Dim contador_titulares As Integer

Private Sub Form_Activate()
         Me.lv_clientes.ListItems.Clear
         Me.lv_gruposactuales.ListItems.Clear
         Me.lv_gruposreales.ListItems.Clear
         Me.lv_titulares.ListItems.Clear
         Call pro_llena_gruposactuales
         Call pro_textos_gruposactuales
         Call pro_llena_gruposreales
         Call pro_textos_gruposreales
         Call pro_llena_titulares
         Call pro_textos_titulares
End Sub

Private Sub Form_Load()
   Frmmenu2.StatusBar1.Panels(1) = "Presione F6 para entrar al catálogo"
   var_tipo_filtrado_cliente = 2
   var_cadena_seguridad = ""
   Top = 0
   Left = 0
   Call pro_llena_gruposactuales
   Call pro_textos_gruposactuales
   Call pro_llena_gruposreales
   Call pro_textos_gruposreales
   Call pro_llena_titulares
   Call pro_textos_titulares
End Sub
Sub pro_llena_gruposactuales()
Dim list_item As ListItem
   contador_grupos_actuales = 0
   rs.Open "select * from TB_gruposactuales where vcha_emp_empresa_id = '" + var_empresa + "'", cnn, adOpenDynamic, adLockOptimistic
   While Not rs.EOF
      Set list_item = lv_gruposactuales.ListItems.Add(, , rs!VCHA_GAC_GRUPO_ACTUAL_ID)
      list_item.SubItems(1) = IIf(IsNull(rs!vcha_gac_nombre), "", rs!vcha_gac_nombre)
      rs.MoveNext:
      contador_grupos_reales = contador_grupos_reales + 1
   Wend
   rs.Close
   Call pro_llena_gruposreales
   Call pro_textos_gruposreales
End Sub
Sub pro_textos_gruposactuales()
'On Error GoTo err0:
Dim var_n As Integer
   txt_grupo_actual = ""
   txt_nombre_grupo_actual = ""
   var_n = lv_gruposactuales.ListItems.Count
   If var_n > 0 Then
      txt_grupo_actual = lv_gruposactuales.selectedItem
      txt_nombre_grupo_actual = lv_gruposactuales.selectedItem.SubItems(1)
   End If
   var_numero_renglones = lv_gruposactuales.Height / 312.5
   If var_n > var_numero_renglones Then
      lv_gruposactuales.ColumnHeaders(2).Width = 4200
   Else
      lv_gruposactuales.ColumnHeaders(2).Width = 4400
   End If
err0:
End Sub


Private Sub Form_Unload(Cancel As Integer)
    If var_activa_menu = True Then
       Frmmenu2.Enabled = True
    End If
End Sub

Private Sub lv_clientes_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
   Call pro_ordena_listas(lv_clientes, ColumnHeader)
End Sub

Private Sub lv_clientes_ItemClick(ByVal Item As MSComctlLib.ListItem)
   Call pro_textos_clientes
End Sub

Private Sub lv_clientes_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_titulares.ListItems.Count > 0 Then
         var_activa_forma_clientes = Me.Name
         frmclientes2.Enabled = False
         frmclientes.Show
      End If
   End If
End Sub

Private Sub lv_gruposactuales_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
   Call pro_ordena_listas(lv_gruposactuales, ColumnHeader)
End Sub

Private Sub lv_gruposactuales_ItemClick(ByVal Item As MSComctlLib.ListItem)
   Call pro_textos_gruposactuales
   Call pro_llena_gruposreales
End Sub
Sub pro_llena_gruposreales()
   Dim list_item As ListItem
   lv_gruposreales.ListItems.Clear
   var_grupoactual = ""
   If lv_gruposactuales.ListItems.Count Then
      var_grupoactual = lv_gruposactuales.selectedItem
      rsaux2.Open "select * from TB_gruposreales where vcha_gac_grupo_actual_id = '" + var_grupoactual + "'  and vcha_emp_empresa_id = '" + var_empresa + "'", cnn, adOpenDynamic, adLockOptimistic
      While Not rsaux2.EOF
         Set list_item = lv_gruposreales.ListItems.Add(, , rsaux2!vcha_gre_grupo_real_id)
         list_item.SubItems(1) = IIf(IsNull(rsaux2!VCHA_GRE_NOMBRE), "", rsaux2!VCHA_GRE_NOMBRE)
         rsaux2.MoveNext:
       Wend
       rsaux2.Close
   End If
   Call pro_llena_titulares
   Call pro_textos_titulares
End Sub

Sub pro_llena_titulares()
   'On Error GoTo salir:
   Dim list_item As ListItem
   lv_titulares.ListItems.Clear
   var_gruporeal = ""
   If lv_gruposreales.ListItems.Count > 0 Then
      var_gruporeal = lv_gruposreales.selectedItem
      rs.Open "select distinct vcha_tit_titular_id,vcha_tit_nombre from tb_titulares where VCHA_GRE_GRUPO_REAL_ID = '" + var_gruporeal + "' and vcha_emp_empresa_id = '" + var_empresa + "'", cnn, adOpenDynamic, adLockOptimistic
      While Not rs.EOF
         Set list_item = lv_titulares.ListItems.Add(, , rs!vcha_tit_titular_id)
         list_item.SubItems(1) = IIf(IsNull(rs!vcha_tit_nombre), "", rs!vcha_tit_nombre)
         rs.MoveNext:
      Wend
      rs.Close
   End If
   Call pro_llena_clientes
   Call pro_textos_clientes
salir:
End Sub

Private Sub lv_gruposactuales_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      var_activa_forma_gruposactuales = Me.Name
      frmclientes2.Enabled = False
      frmgruposactuales.Show
   End If
End Sub

Private Sub lv_gruposreales_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
   Call pro_ordena_listas(lv_gruposreales, ColumnHeader)
End Sub

Private Sub lv_gruposreales_ItemClick(ByVal Item As MSComctlLib.ListItem)
   Call pro_textos_gruposreales
   Call pro_llena_titulares
   Call pro_textos_titulares
End Sub
Sub pro_textos_titulares()
'On Error GoTo err0:
Dim var_n As Integer
   var_n = lv_titulares.ListItems.Count
   txt_titular = ""
   txt_nombre_titular = ""
   If var_n > 0 Then
      txt_titular = lv_titulares.selectedItem
      txt_nombre_titular = lv_titulares.selectedItem.SubItems(1)
   End If
   var_numero_renglones = lv_titulares.Height / 312.5
   If var_n > var_numero_renglones Then
      lv_titulares.ColumnHeaders(2).Width = 3950
   Else
      lv_titulares.ColumnHeaders(2).Width = 4199.9
   End If
err0:
End Sub


Private Sub lv_gruposreales_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposactuales.ListItems.Count > 0 Then
         var_activa_forma_gruposreales = Me.Name
         frmclientes2.Enabled = False
         frmgruposreales.Show
      Else
         MsgBox "No se a seleccionado un grupo actual", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub lv_titulares_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
   Call pro_ordena_listas(lv_titulares, ColumnHeader)
End Sub

Private Sub lv_titulares_ItemClick(ByVal Item As MSComctlLib.ListItem)
   Call pro_textos_titulares
   Call pro_llena_clientes
   Call pro_textos_clientes
End Sub
Sub pro_textos_gruposreales()
'   On Error GoTo salir:
Dim var_n As Integer
   var_n = lv_gruposreales.ListItems.Count
   txt_grupo_real = ""
   txt_nombre_grupo_real = ""
   If var_n > 0 Then
      txt_grupo_real = lv_gruposreales.selectedItem
      txt_nombre_grupo_real = lv_gruposreales.selectedItem.SubItems(1)
   End If
   var_numero_renglones = lv_gruposreales.Height / 312.5
   If var_n > var_numero_renglones Then
      lv_gruposreales.ColumnHeaders(2).Width = 4120
   Else
      lv_gruposreales.ColumnHeaders(2).Width = 4420
   End If
salir:
End Sub


Sub pro_textos_clientes()
   Dim var_n As Integer
   var_n = lv_clientes.ListItems.Count
   txt_cliente = ""
   txt_nombre_cliente = ""
   If var_n > 0 Then
      txt_cliente = lv_clientes.selectedItem
      txt_nombre_cliente = lv_clientes.selectedItem.SubItems(1)
   End If
   var_numero_renglones = lv_clientes.Height / 312.5
   If var_n > var_numero_renglones Then
      lv_clientes.ColumnHeaders(2).Width = 3970
   Else
      lv_clientes.ColumnHeaders(2).Width = 4199.9
   End If
err0:
End Sub


Sub pro_llena_clientes()
   On Error GoTo err0:
   Dim list_item As ListItem
   Dim var_cadena As String
   lv_clientes.ListItems.Clear
   var_titular = ""
   If lv_titulares.ListItems.Count > 0 Then
      var_titular = lv_titulares.selectedItem
      var_cadena = "select * from tb_clientes where vcha_tit_titular_id = '" + var_titular + "' and vcha_emp_empresa_id = '" + var_empresa + "'"
      rs.Open var_cadena, cnn, adOpenDynamic, adLockOptimistic
      While Not rs.EOF
         Set list_item = lv_clientes.ListItems.Add(, , rs!vcha_cli_clave_id)
         list_item.SubItems(1) = IIf(IsNull(rs!vcha_cli_nombre), "", rs!vcha_cli_nombre)
         rs.MoveNext:
      Wend
      rs.Close
   End If
err0:
End Sub




Private Sub lv_titulares_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposreales.ListItems.Count > 0 Then
         var_activa_forma_titulares = Me.Name
         frmclientes2.Enabled = False
         frmtitulares.Show
      Else
         MsgBox "No se a seleccionado un titular", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_cliente_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_titulares.ListItems.Count > 0 Then
         var_activa_forma_clientes = Me.Name
         frmclientes2.Enabled = False
         frmclientes.Show
      Else
         MsgBox "No se a seleccionado un titular", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_cliente_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_grupo_actual_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      var_activa_forma_gruposactuales = Me.Name
      frmgruposactuales.Show
      frmclientes2.Enabled = False
   End If
End Sub

Private Sub txt_grupo_actual_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_grupo_real_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposactuales.ListItems.Count > 0 Then
         var_activa_forma_gruposreales = Me.Name
         frmclientes2.Enabled = False
         frmgruposreales.Show
      Else
         MsgBox "No se a seleccionado un grupo real", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_grupo_real_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_nombre_cliente_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_titulares.ListItems.Count > 0 Then
         var_activa_forma_clientes = Me.Name
         frmclientes2.Enabled = False
         frmclientes.Show
      Else
         MsgBox "No se a seleccionado un titular", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_nombre_cliente_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_nombre_grupo_actual_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      var_activa_forma_gruposactuales = Me.Name
      frmclientes2.Enabled = False
      frmgruposactuales.Show
   End If
End Sub

Private Sub txt_nombre_grupo_actual_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_nombre_grupo_real_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposactuales.ListItems.Count > 0 Then
         var_activa_forma_gruposreales = Me.Name
         frmclientes2.Enabled = False
         frmgruposactuales.Show
      Else
         MsgBox "No se a seleccionado un grupo actual", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_nombre_grupo_real_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_nombre_titular_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposreales.ListItems.Count > 0 Then
         var_activa_forma_titulares = Me.Name
         frmclientes2.Enabled = False
         frmtitulares.Show
      Else
         MsgBox "No se a seleccionado un grupo real", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_nombre_titular_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub

Private Sub txt_titular_KeyDown(KeyCode As Integer, Shift As Integer)
   If KeyCode = 117 Then
      If lv_gruposreales.ListItems.Count > 0 Then
         var_activa_forma_titulares = Me.Name
         frmclientes2.Enabled = False
         frmtitulares.Show
      Else
         MsgBox "No se a seleccionado un grupo real", vbOKOnly, "ATENCION"
      End If
   End If
End Sub

Private Sub txt_titular_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 13 Then
      KeyAscii = 0
   Else
      Call pro_enfoque(KeyAscii)
   End If
End Sub
